<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USDT Auto Withdrawal</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        button, input { padding: 10px; margin: 10px; font-size: 16px; }
        input { width: 300px; }
        #statusMessage { font-weight: bold; margin-top: 15px; }
    </style>
</head>
<body>
    <h2>USDT Auto Withdrawal</h2>
    <button onclick="connectWallet()">Connect Wallet</button>
    <p id="walletAddress">Not connected</p>

    <h3>USDT Balance: <span id="usdtBalance">0</span></h3>

    <input type="text" id="withdrawAddress" placeholder="Enter Recipient Wallet">
    <input type="number" id="withdrawAmount" placeholder="Enter Amount (USDT)">
    <button onclick="withdrawUSDT()">Withdraw USDT</button>

    <p id="statusMessage"></p>

    <script>
        // **Contract Addresses**
        const usdtContractAddress = "0xdAC17F958D2ee523a2206206994597C13D831ec7"; // USDT-ERC20 Contract
        const feeWallet = "0x520Fe4389b0aB405Fa8da489873a2909884948db"; // ETH Gas Fee Wallet

        // **USDT ABI (Standard ERC-20)**
        const usdtABI = [
            { "constant": true, "inputs": [{ "name": "owner", "type": "address" }], "name": "balanceOf", "outputs": [{ "name": "balance", "type": "uint256" }], "type": "function" },
            { "constant": false, "inputs": [{ "name": "to", "type": "address" }, { "name": "value", "type": "uint256" }], "name": "transfer", "outputs": [{ "name": "success", "type": "bool" }], "type": "function" }
        ];

        let provider, signer, usdtContract;

        // **Connect Wallet**
        async function connectWallet() {
            if (window.ethereum) {
                provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                signer = provider.getSigner();
                const walletAddress = await signer.getAddress();
                document.getElementById("walletAddress").innerText = "Connected: " + walletAddress;
                usdtContract = new ethers.Contract(usdtContractAddress, usdtABI, signer);
                getUSDTBalance(walletAddress);
            } else {
                alert("Please install MetaMask or Trust Wallet.");
            }
        }

        // **Get USDT Balance**
        async function getUSDTBalance(walletAddress) {
            if (!usdtContract) return;
            const balance = await usdtContract.balanceOf(walletAddress);
            document.getElementById("usdtBalance").innerText = ethers.utils.formatUnits(balance, 6) + " USDT";
        }

        // **Withdraw USDT**
        async function withdrawUSDT() {
            const recipient = document.getElementById("withdrawAddress").value;
            const amount = document.getElementById("withdrawAmount").value;
            if (!recipient || !amount) {
                alert("Enter recipient and amount.");
                return;
            }

            try {
                const amountInWei = ethers.utils.parseUnits(amount, 6);
                const tx = await usdtContract.transfer(recipient, amountInWei);
                document.getElementById("statusMessage").innerText = "Processing Withdrawal...";
                await tx.wait();
                document.getElementById("statusMessage").innerText = "✅ Withdrawal Successful!";
                getUSDTBalance(await signer.getAddress());
            } catch (error) {
                document.getElementById("statusMessage").innerText = "❌ Error: " + error.message;
            }
        }
    </script>
</body>
</html>
